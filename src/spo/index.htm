<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>ファイルリンクリダイレクト</title>

<style>

ul {
    list-style:none;
}

.utl_color_error {
    color:red;
}

.utl_color_info {
    color:blue;
}

.utl_display_none {
    display:none;
}


</style>

</head>
<body>

<main id="contents">

<article id="article_main">
    <h1>ファイル/フォルダへのリダイレクト</h1>
    
    <p>本ページはクエリ文字?path=\\foo\bar\baz.hogeへリダイレクトする</p>
    
    <ul id="article_main_messages">
        <li></li>
    </ul>

</article>

<nav id="nav_main">
    <ul>
        <li><a id="file_path" href="" target="_self">ここをクリックするとファイルパスにアクセスします</a></li>
    </ul>
</nav>

<form name="form_main" action="" method="GET" target="_self">
</form>

</main>

<script>

/*
*   クエリ文字?path=\\foo\bar\baz.hogeへリダイレクトする
*/
(function() {
    const QUERY_STRING_KEY = 'path'

    window.addEventListener('load', (event) => {
        const query_string = decodeURI(window.location.search) || ''
        const fixed_string = '?' + QUERY_STRING_KEY + '='

        const original_href = query_string.slice(
            fixed_string.length
            )

        const href = original_href == ''?
            '':
            'file:///' + original_href.replaceAll('\\', '/')

        const message = href?
            '取得したファイルパス＝' + original_href :
            'ファイルパスの取得を失敗しました( ' + query_string + ' )'

        const elm_form = document.querySelector('form[name="form_main"]')
        elm_form.action = href

        const elm_message = document.querySelector(
            '#article_main_messages>li:first-child'
            )
        elm_message.textContent = message

        const elm_anchor = document.querySelector('#file_path')
        elm_anchor.href = href

        if (! original_href) {
            elm_message.classList.add('utl_color_error')
            elm_anchor.classList.add('utl_display_none')
            return
        }

        document.form_main.submit()
    },false)
})()

</script>

</body>
</html>
